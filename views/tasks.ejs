<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tasks</title>
    <link rel="stylesheet" href="/index.css" />
</head>

<body>
    <div class="wrap">
        <div class="topbar">
            <h2>Your Tasks</h2>
            <form method="POST" action="/logout">
                <button class="secondary" type="submit">Logout</button>
            </form>
        </div>

        <div class="filters">
            <a class="<%= filter === 'pending' ? 'active' : '' %>" href="/tasks?filter=pending">Pending</a>
            <a class="<%= filter === 'completed' ? 'active' : '' %>" href="/tasks?filter=completed">Completed</a>
        </div>

        <% if (error) { %>
            <p class="error">
                <%= error %>
            </p>
            <% } %>

                <div class="card">
                    <form method="POST" action="/tasks">
                        <input name="title" placeholder="Add a task" />
                        <button type="submit">Add</button>
                    </form>
                </div>

                <div class="list">
                    <% if (tasks.length===0) { %>
                        <p class="muted">No tasks here.</p>
                        <% } %>

                            <% tasks.forEach(t=> { %>
                                <div class="item">
                                    <div class="title">
                                        <%= t.title %>
                                    </div>

                                    <div class="actions">
                                        <% if (t.status==='pending' ) { %>
                                            <form method="POST" action="/tasks/<%= t._id %>/complete">
                                                <button type="submit">Complete</button>
                                            </form>
                                            <% } %>

                                                <form method="POST"
                                                    action="/tasks/<%= t._id %>/delete?back=<%= filter %>">
                                                    <button class="danger" type="submit">Delete</button>
                                                </form>
                                    </div>
                                </div>
                                <% }); %>
                </div>
    </div>
</body>

</html>